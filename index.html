<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Verilog Viewer</title>
</head>

<body onload="init()">

<h1>Verilog Collective (Minimal Version)</h1>

<button onclick="refreshAll()">Refresh All Files</button>
<hr>

<!-- DECODER SECTION -->
<h2>Decoder</h2>
<p>Files: verilog/decoder.v and verilog/decoder_tb.v</p>

<button onclick="showSection('decoder-module')">Show Module</button>
<button onclick="showSection('decoder-tb')">Show Testbench</button>

<pre id="decoder-module" style="display:block;">Loading...</pre>
<pre id="decoder-tb" style="display:none;">Loading...</pre>

<button onclick="copyText('decoder-module')">Copy Module</button>
<button onclick="copyText('decoder-tb')">Copy Testbench</button>

<hr>

<!-- MUX SECTION -->
<h2>MUX</h2>
<p>Files: verilog/mux.v and verilog/mux_tb.v</p>

<button onclick="showSection('mux-module')">Show Module</button>
<button onclick="showSection('mux-tb')">Show Testbench</button>

<pre id="mux-module" style="display:block;">Loading...</pre>
<pre id="mux-tb" style="display:none;">Loading...</pre>

<button onclick="copyText('mux-module')">Copy Module</button>
<button onclick="copyText('mux-tb')">Copy Testbench</button>

<hr>

<script>
// Files to load
const FILES = {
    "decoder-module":  "verilog/decoder.v",
    "decoder-tb":      "verilog/decoder_tb.v",
    "mux-module":      "verilog/mux.v",
    "mux-tb":          "verilog/mux_tb.v"
};

// Load text from file
async function loadFile(elementId, filePath) {
    try {
        const res = await fetch(filePath, { cache: "no-store" });
        if (!res.ok) throw new Error("HTTP " + res.status);
        const text = await res.text();
        document.getElementById(elementId).textContent = text;
    } catch (err) {
        document.getElementById(elementId).textContent = "// Error loading " + filePath;
    }
}

// Load all files
function init() {
    for (const id in FILES) {
        loadFile(id, FILES[id]);
    }
}

// Refresh button
function refreshAll() {
    init();
}

// Show selected <pre> block
function showSection(idToShow) {
    ["decoder-module", "decoder-tb", "mux-module", "mux-tb"].forEach(id => {
        document.getElementById(id).style.display = (id === idToShow) ? "block" : "none";
    });
}

// Copy to clipboard
function copyText(id) {
    const text = document.getElementById(id).textContent;
    navigator.clipboard.writeText(text)
        .then(() => alert("Copied!"))
        .catch(() => alert("Copy failed"));
}

</script>

</body>
</html>
